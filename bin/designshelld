#!/usr/bin/env ruby
#
# This file was generated by Bundler.
#
# The application 'designshelld' is installed as part of a gem, and
# this file is here to facilitate running it.
#

# This was then hacked so that it could be called direct from authorized_keys command=...

#require 'pathname'
#
##ENV['BUNDLE_GEMFILE'] ||= File.expand_path("../../Gemfile",Pathname.new(__FILE__).realpath) # was before rubygems
#require 'rubygems'
#ds_dir = (spec = Gem::Specification.find_by_name('designshell')) && spec.gem_dir
#ENV['BUNDLE_GEMFILE'] = File.expand_path("Gemfile",Pathname.new(ds_dir).realpath)
#require 'bundler/setup'
#
##load Gem.bin_path('designshell', 'designshelld')

require 'rubygems'
gem 'designshell'
require 'designshellserver'

#trap("SIGHUP") { abort }

context = DesignShell::Context.new({
	:argv=>ARGV.clone,
	:env=>ENV.clone,
	:stdout=>$stdout,
	:stdin=>$stdin,
	:stderr=>$stderr,
  :credentials=>Credentials.new('DesignShellServer')
})
core = DesignShellServer::Core.new(context)
core.run
